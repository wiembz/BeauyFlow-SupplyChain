<div class="floating-icons">
  <button (click)="toggleMessages()" class="icon-button">
    📩
  </button>
  <button (click)="toggleNewMessage()" class="icon-button">
    ➕
  </button>
</div>

<div class="main-content">
  <iframe
    width="100%"
    height="100%"
    [src]="dashboardUrl"
    frameborder="0"
    allowfullscreen
    class="dashboard-frame">
  </iframe>

  <!-- Messages -->
  <div *ngIf="showMessages" class="messages-panel">
    <h2>📨 Messages</h2>
    <div *ngIf="messages.length > 0; else noMessages">
      <div *ngFor="let message of messages" class="message-card">
        <p><strong>{{ message.author_id[1] }}</strong> :</p>
        <div [innerHTML]="message.body"></div>
        <small>{{ message.date }}</small>
      </div>
    </div>
    <ng-template #noMessages>
      <p> No messages ! </p>
    </ng-template>
  </div>

  <!-- Nouveau Message -->
  <div *ngIf="showNewMessage" class="new-message-panel">
    <h2>📝 Send your message </h2>

    <select [(ngModel)]="selectedDestinataireId" class="select-input">
      <option [value]="null" disabled selected> Open me </option>
      <option *ngFor="let user of users" [value]="user.id">
        {{ user.name }}
      </option>
    </select>

    <textarea [(ngModel)]="newMessage" placeholder="Écrire votre message..." class="textarea-input"></textarea>

    <button (click)="sendMessage()" class="send-button">Envoyer</button>
  </div>

  <!-- Message envoyé -->
  <div *ngIf="messageSent" class="toast-message">
    Message send successfully ✅
  </div>

</div>
